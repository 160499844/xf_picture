<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>媒体中心</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/static/layui/css/layui.css" media="all">
    <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/static/pic_utils/css/zoom.css">


    <script src="/static/pic_utils/js/jquery.min.js"></script>
    <script src="/static/pic_utils/js/zoom.js"></script>
    <style>
        .coverImg{
            width:100%;
            height:auto;
        }
        .pic-item-div{
            margin: 2px;
            height: 300px;
        }
        .result{position: fixed;top:0;left:0;background: rgba(0,0,0,0.5);z-index:1000;width:100%;height:100%;display: none;}
        .imgresult{border:5px solid #fff;}
        .indiv{position: absolute;}
    </style>
</head>
<body>

<div class="layui-container">
    <div class="layui-row">
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">
            <legend>全部</legend>
        </fieldset>

        <ul class="flow-default" style="height: 300px;" id="LAY_demo2"></ul>
    </div>

    <script src="/static/layui/layui.js" charset="utf-8"></script>
    <!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
    <script>
        var id = {{ id }};
        layui.use('flow', function(){
            var $ = layui.jquery; //不用额外加载jQuery，flow模块本身是有依赖jQuery的，直接用即可。

            var flow = layui.flow;


            flow.load({
                elem: '#LAY_demo2' //流加载容器
                ,isLazyimg: true
                ,done: function(page, next) { //加载下一页
                    //模拟插入
                    /*setTimeout(function(){
                  var lis = [];
                  for(var i = 0; i < 6; i++){
                    lis.push('<li><img lay-src="http://127.0.0.1:8000/group/?imgCode=43&v='+ ( (page-1)*6 + i + 1 ) +'"></li>')
                  }
                  next(lis.join(''), page < 6); //假设总页数为 6
                }, 500);*/
                    var lis = [];
                    //以jQuery的Ajax请求为例，请求下一页数据（注意：page是从2开始返回）
                    $.get('/api/getPage?id='+id+'&page=' + page, function (res) {
                        //假设你的列表返回在data集合中
                        layui.each(res.content, function (index, item) {
                            //console.log("item",item);
                            lis.push('<div class="layui-col-xs2 pic-item-div">' +
                                '<img data-action="zoom" class="coverImg" lay-src="/group/?imgCode=' + item.imgCode + '">' +
                                '</div>');
                        });
                        console.log("当前页数:",page);
                        //执行下一页渲染，第二参数为：满足“加载更多”的条件，即后面仍有分页
                        //pages为Ajax返回的总页数，只有当前页小于总页数的情况下，才会继续出现加载更多
                        next(lis.join(''), page < res.count);
                    })
                }
            });


        });
    </script>
</div>
</body>
</html>